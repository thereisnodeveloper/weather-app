"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getRegularClassesMap = exports.getParentSelectorClassesMap = exports.getICSSExportPropsMap = exports.getExtendClassesMap = exports.getComposesClassesMap = exports.eliminateGlobals = void 0;
var _fp = _interopRequireDefault(require("lodash/fp"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }
/* eslint-disable no-param-reassign */
var getICSSExportPropsMap = exports.getICSSExportPropsMap = function getICSSExportPropsMap(ast) {
  var ruleSets = [];
  ast.traverseByType('ruleset', function (node) {
    return ruleSets.push(node);
  });
  return _fp["default"].compose(_fp["default"].reduce(function (result, key) {
    var prop = _fp["default"].compose(_fp["default"].nth(0), _fp["default"].map('content'))(key);
    result[prop] = prop; // e.g. { myProp: 'myProp' }
    return result;
  }, {}), _fp["default"].map('content'), _fp["default"].filter({
    type: 'property'
  }), _fp["default"].flatMap('content'), _fp["default"].filter({
    type: 'declaration'
  }), _fp["default"].flatMap('content'), _fp["default"].filter({
    type: 'block'
  }), _fp["default"].flatMap('content'), _fp["default"].filter({
    content: [{
      type: 'selector',
      content: [{
        type: 'pseudoClass',
        content: [{
          type: 'ident',
          content: 'export'
        }]
      }]
    }]
  }))(ruleSets);
};
var getRegularClassesMap = exports.getRegularClassesMap = function getRegularClassesMap(ast) {
  var ruleSets = [];
  ast.traverseByType('ruleset', function (node) {
    return ruleSets.push(node);
  });
  return _fp["default"].compose(_fp["default"].reduce(function (result, key) {
    result[key] = false; // classes haven't been used
    return result;
  }, {}), _fp["default"].map('content'), _fp["default"].filter({
    type: 'ident'
  }), _fp["default"].flatMap('content'), _fp["default"].filter({
    type: 'class'
  }), _fp["default"].flatMap('content'), _fp["default"].filter({
    type: 'selector'
  }), _fp["default"].flatMap('content'))(ruleSets);
};
var getComposesClassesMap = exports.getComposesClassesMap = function getComposesClassesMap(ast) {
  var declarations = [];
  ast.traverseByType('declaration', function (node) {
    return declarations.push(node);
  });
  return _fp["default"].compose(_fp["default"].reduce(function (result, key) {
    result[key] = true; // mark composed classes as true
    return result;
  }, {}), _fp["default"].flatMap(_fp["default"].compose(_fp["default"].map(_fp["default"].get('content')), _fp["default"].filter({
    type: 'ident'
  }), _fp["default"].get('content'), _fp["default"].find({
    type: 'value'
  }), _fp["default"].get('content'))),
  /*
     reject classes composing from other files
     eg.
     .foo {
     composes: .bar from './otherFile';
     }
   */
  _fp["default"].reject(_fp["default"].compose(_fp["default"].find({
    type: 'ident',
    content: 'from'
  }), _fp["default"].get('content'), _fp["default"].find({
    type: 'value'
  }), _fp["default"].get('content'))), _fp["default"].filter(_fp["default"].compose(_fp["default"].find({
    type: 'ident',
    content: 'composes'
  }), _fp["default"].get('content'), _fp["default"].find({
    type: 'property'
  }), _fp["default"].get('content'))))(declarations);
};
var getExtendClassesMap = exports.getExtendClassesMap = function getExtendClassesMap(ast) {
  var extendNodes = [];
  ast.traverseByType('extend', function (node) {
    return extendNodes.push(node);
  });
  return _fp["default"].compose(_fp["default"].reduce(function (result, key) {
    result[key] = true; // mark extend classes as true
    return result;
  }, {}), _fp["default"].map(_fp["default"].compose(_fp["default"].get('content'), _fp["default"].find({
    type: 'ident'
  }), _fp["default"].get('content'), _fp["default"].find({
    type: 'class'
  }), _fp["default"].get('content'), _fp["default"].find({
    type: 'selector'
  }), _fp["default"].get('content'))))(extendNodes);
};

/**
 * Resolves parent selectors to their full class names.
 *
 * E.g. `.foo { &_bar {color: blue } }` to `.foo_bar`.
 */
var getParentSelectorClassesMap = exports.getParentSelectorClassesMap = function getParentSelectorClassesMap(ast) {
  var classesMap = {};

  // Recursively traverses down the tree looking for parent selector
  // extensions. Recursion is necessary as these selectors can be nested.
  var getExtensions = function getExtensions(nodeContent) {
    var blockContent = _fp["default"].compose(_fp["default"].flatMap('content'), _fp["default"].filter({
      type: 'block'
    }))(nodeContent);
    var rulesetsContent = _fp["default"].flatMap('content', _fp["default"].concat(
    // `ruleset` children
    _fp["default"].filter({
      type: 'ruleset'
    }, blockContent),
    // `ruleset` descendants nested in `include` nodes
    _fp["default"].compose(_fp["default"].filter({
      type: 'ruleset'
    }), _fp["default"].flatMap('content'), _fp["default"].filter({
      type: 'block'
    }), _fp["default"].flatMap('content'), _fp["default"].filter({
      type: 'include'
    }))(blockContent)));
    var extensions = _fp["default"].compose(_fp["default"].map('content'), _fp["default"].filter({
      type: 'ident'
    }), _fp["default"].flatMap('content'), _fp["default"].filter({
      type: 'parentSelectorExtension'
    }), _fp["default"].flatMap('content'), _fp["default"].filter({
      type: 'selector'
    }))(rulesetsContent);
    if (!extensions.length) return [];
    var nestedExtensions = getExtensions(rulesetsContent);
    var result = extensions;
    if (nestedExtensions.length) {
      nestedExtensions.forEach(function (nestedExt) {
        extensions.forEach(function (ext) {
          result.push(ext + nestedExt);
        });
      });
    }
    return result;
  };
  ast.traverseByType('ruleset', function (node) {
    var classNames = _fp["default"].compose(_fp["default"].map('content'), _fp["default"].filter({
      type: 'ident'
    }), _fp["default"].flatMap('content'), _fp["default"].filter({
      type: 'class'
    }), _fp["default"].flatMap('content'), _fp["default"].filter({
      type: 'selector'
    }))(node.content);
    if (!classNames.length) return;
    var extensions = getExtensions(node.content);
    if (!extensions.length) return;
    classNames.forEach(function (className) {
      extensions.forEach(function (ext) {
        classesMap[className + ext] = false;
      });

      // Ignore the base class if it only exists for nesting parent selectors
      var hasDeclarations = _fp["default"].compose(_fp["default"].filter({
        type: 'declaration'
      }), _fp["default"].flatMap('content'), _fp["default"].filter({
        type: 'block'
      }))(node.content).length > 0;
      if (!hasDeclarations) classesMap[className] = true;
    });
  });
  return classesMap;
};

/**
 * Mutates the AST by removing `:global` instances.
 *
 * For the AST structure:
 * @see https://github.com/css/gonzales/blob/master/doc/AST.CSSP.en.md
 */
var eliminateGlobals = exports.eliminateGlobals = function eliminateGlobals(ast) {
  // Remove all :global/:global(...) in selectors
  ast.traverseByType('selector', function (selectorNode) {
    var selectorContent = selectorNode.content;
    var hasGlobalWithNoArgs = false;
    var i = 0;
    var currNode = selectorContent[i];
    while (currNode) {
      if (currNode.is('pseudoClass')) {
        // Remove all :global/:global(...) and trailing space
        var identifierNode = currNode.content[0];
        if (identifierNode && identifierNode.content === 'global') {
          if (currNode.content.length === 1) hasGlobalWithNoArgs = true;
          selectorNode.removeChild(i);
          if (selectorContent[i] && selectorContent[i].is('space')) {
            selectorNode.removeChild(i);
          }
        } else {
          i++;
        }
      } else if (currNode.is('class') && hasGlobalWithNoArgs) {
        // Remove all class after :global and their trailing space
        selectorNode.removeChild(i);
        if (selectorContent[i] && selectorContent[i].is('space')) {
          selectorNode.removeChild(i);
        }
      } else {
        i++;
      }
      currNode = selectorContent[i];
    }
  });

  // Remove all ruleset with no selectors
  ast.traverseByType('ruleset', function (node, index, parent) {
    var rulesetContent = node.content;

    // Remove empty selectors and trailing deliminator and space
    var i = 0;
    var currNode = rulesetContent[i];
    while (currNode) {
      if (currNode.is('selector') && currNode.content.length === 0) {
        node.removeChild(i);
        if (rulesetContent[i].is('delimiter')) node.removeChild(i);
        if (rulesetContent[i].is('space')) node.removeChild(i);
      } else {
        i++;
      }
      currNode = rulesetContent[i];
    }

    // Remove the ruleset if no selectors
    if (rulesetContent.filter(function (node) {
      return node.is('selector');
    }).length === 0) {
      parent.removeChild(index);
    }
  });
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZnAiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIm9iaiIsIl9fZXNNb2R1bGUiLCJnZXRJQ1NTRXhwb3J0UHJvcHNNYXAiLCJleHBvcnRzIiwiYXN0IiwicnVsZVNldHMiLCJ0cmF2ZXJzZUJ5VHlwZSIsIm5vZGUiLCJwdXNoIiwiZnAiLCJjb21wb3NlIiwicmVkdWNlIiwicmVzdWx0Iiwia2V5IiwicHJvcCIsIm50aCIsIm1hcCIsImZpbHRlciIsInR5cGUiLCJmbGF0TWFwIiwiY29udGVudCIsImdldFJlZ3VsYXJDbGFzc2VzTWFwIiwiZ2V0Q29tcG9zZXNDbGFzc2VzTWFwIiwiZGVjbGFyYXRpb25zIiwiZ2V0IiwiZmluZCIsInJlamVjdCIsImdldEV4dGVuZENsYXNzZXNNYXAiLCJleHRlbmROb2RlcyIsImdldFBhcmVudFNlbGVjdG9yQ2xhc3Nlc01hcCIsImNsYXNzZXNNYXAiLCJnZXRFeHRlbnNpb25zIiwibm9kZUNvbnRlbnQiLCJibG9ja0NvbnRlbnQiLCJydWxlc2V0c0NvbnRlbnQiLCJjb25jYXQiLCJleHRlbnNpb25zIiwibGVuZ3RoIiwibmVzdGVkRXh0ZW5zaW9ucyIsImZvckVhY2giLCJuZXN0ZWRFeHQiLCJleHQiLCJjbGFzc05hbWVzIiwiY2xhc3NOYW1lIiwiaGFzRGVjbGFyYXRpb25zIiwiZWxpbWluYXRlR2xvYmFscyIsInNlbGVjdG9yTm9kZSIsInNlbGVjdG9yQ29udGVudCIsImhhc0dsb2JhbFdpdGhOb0FyZ3MiLCJpIiwiY3Vyck5vZGUiLCJpcyIsImlkZW50aWZpZXJOb2RlIiwicmVtb3ZlQ2hpbGQiLCJpbmRleCIsInBhcmVudCIsInJ1bGVzZXRDb250ZW50Il0sInNvdXJjZXMiOlsiLi4vLi4vbGliL2NvcmUvdHJhdmVyc2FsVXRpbHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQGZsb3dcbi8qIGVzbGludC1kaXNhYmxlIG5vLXBhcmFtLXJlYXNzaWduICovXG5pbXBvcnQgZnAgZnJvbSAnbG9kYXNoL2ZwJztcblxuaW1wb3J0IHR5cGUgeyBnQVNUTm9kZSB9IGZyb20gJy4uL3R5cGVzJztcblxudHlwZSBjbGFzc01hcFR5cGUgPSB7XG4gIFtrZXk6IHN0cmluZ106IGJvb2xlYW4sXG59XG5cbmV4cG9ydCBjb25zdCBnZXRJQ1NTRXhwb3J0UHJvcHNNYXAgPSAoYXN0OiBnQVNUTm9kZSk6IGNsYXNzTWFwVHlwZSA9PiB7XG4gIGNvbnN0IHJ1bGVTZXRzOiBBcnJheTxnQVNUTm9kZT4gPSBbXTtcbiAgYXN0LnRyYXZlcnNlQnlUeXBlKCdydWxlc2V0Jywgbm9kZSA9PiBydWxlU2V0cy5wdXNoKG5vZGUpKTtcblxuICByZXR1cm4gZnAuY29tcG9zZShcbiAgICBmcC5yZWR1Y2UoKHJlc3VsdCwga2V5KSA9PiB7XG4gICAgICBjb25zdCBwcm9wID0gZnAuY29tcG9zZShmcC5udGgoMCksIGZwLm1hcCgnY29udGVudCcpKShrZXkpO1xuICAgICAgcmVzdWx0W3Byb3BdID0gcHJvcDsgLy8gZS5nLiB7IG15UHJvcDogJ215UHJvcCcgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LCB7fSksXG4gICAgZnAubWFwKCdjb250ZW50JyksXG4gICAgZnAuZmlsdGVyKHsgdHlwZTogJ3Byb3BlcnR5JyB9KSxcbiAgICBmcC5mbGF0TWFwKCdjb250ZW50JyksXG4gICAgZnAuZmlsdGVyKHsgdHlwZTogJ2RlY2xhcmF0aW9uJyB9KSxcbiAgICBmcC5mbGF0TWFwKCdjb250ZW50JyksXG4gICAgZnAuZmlsdGVyKHsgdHlwZTogJ2Jsb2NrJyB9KSxcbiAgICBmcC5mbGF0TWFwKCdjb250ZW50JyksXG4gICAgZnAuZmlsdGVyKHtcbiAgICAgIGNvbnRlbnQ6IFt7XG4gICAgICAgIHR5cGU6ICdzZWxlY3RvcicsXG4gICAgICAgIGNvbnRlbnQ6IFt7XG4gICAgICAgICAgdHlwZTogJ3BzZXVkb0NsYXNzJyxcbiAgICAgICAgICBjb250ZW50OiBbe1xuICAgICAgICAgICAgdHlwZTogJ2lkZW50JywgY29udGVudDogJ2V4cG9ydCdcbiAgICAgICAgICB9XVxuICAgICAgICB9XVxuICAgICAgfV1cbiAgICB9KVxuICApKHJ1bGVTZXRzKTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRSZWd1bGFyQ2xhc3Nlc01hcCA9IChhc3Q6IGdBU1ROb2RlKTogY2xhc3NNYXBUeXBlID0+IHtcbiAgY29uc3QgcnVsZVNldHM6IEFycmF5PGdBU1ROb2RlPiA9IFtdO1xuICBhc3QudHJhdmVyc2VCeVR5cGUoJ3J1bGVzZXQnLCBub2RlID0+IHJ1bGVTZXRzLnB1c2gobm9kZSkpO1xuXG4gIHJldHVybiBmcC5jb21wb3NlKFxuICAgIGZwLnJlZHVjZSgocmVzdWx0LCBrZXkpID0+IHtcbiAgICAgIHJlc3VsdFtrZXldID0gZmFsc2U7IC8vIGNsYXNzZXMgaGF2ZW4ndCBiZWVuIHVzZWRcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSwge30pLFxuICAgIGZwLm1hcCgnY29udGVudCcpLFxuICAgIGZwLmZpbHRlcih7IHR5cGU6ICdpZGVudCcgfSksXG4gICAgZnAuZmxhdE1hcCgnY29udGVudCcpLFxuICAgIGZwLmZpbHRlcih7IHR5cGU6ICdjbGFzcycgfSksXG4gICAgZnAuZmxhdE1hcCgnY29udGVudCcpLFxuICAgIGZwLmZpbHRlcih7IHR5cGU6ICdzZWxlY3RvcicgfSksXG4gICAgZnAuZmxhdE1hcCgnY29udGVudCcpLFxuICApKHJ1bGVTZXRzKTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRDb21wb3Nlc0NsYXNzZXNNYXAgPSAoYXN0OiBnQVNUTm9kZSk6IGNsYXNzTWFwVHlwZSA9PiB7XG4gIGNvbnN0IGRlY2xhcmF0aW9ucyA9IFtdO1xuICBhc3QudHJhdmVyc2VCeVR5cGUoJ2RlY2xhcmF0aW9uJywgbm9kZSA9PiBkZWNsYXJhdGlvbnMucHVzaChub2RlKSk7XG5cbiAgcmV0dXJuIGZwLmNvbXBvc2UoXG4gICAgZnAucmVkdWNlKChyZXN1bHQsIGtleSkgPT4ge1xuICAgICAgcmVzdWx0W2tleV0gPSB0cnVlOyAvLyBtYXJrIGNvbXBvc2VkIGNsYXNzZXMgYXMgdHJ1ZVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LCB7fSksXG4gICAgZnAuZmxhdE1hcChmcC5jb21wb3NlKFxuICAgICAgZnAubWFwKGZwLmdldCgnY29udGVudCcpKSxcbiAgICAgIGZwLmZpbHRlcih7IHR5cGU6ICdpZGVudCcgfSksXG4gICAgICBmcC5nZXQoJ2NvbnRlbnQnKSxcbiAgICAgIGZwLmZpbmQoeyB0eXBlOiAndmFsdWUnIH0pLFxuICAgICAgZnAuZ2V0KCdjb250ZW50JyksXG4gICAgKSksXG4gICAgLypcbiAgICAgICByZWplY3QgY2xhc3NlcyBjb21wb3NpbmcgZnJvbSBvdGhlciBmaWxlc1xuICAgICAgIGVnLlxuICAgICAgIC5mb28ge1xuICAgICAgIGNvbXBvc2VzOiAuYmFyIGZyb20gJy4vb3RoZXJGaWxlJztcbiAgICAgICB9XG4gICAgICovXG4gICAgZnAucmVqZWN0KGZwLmNvbXBvc2UoXG4gICAgICBmcC5maW5kKHsgdHlwZTogJ2lkZW50JywgY29udGVudDogJ2Zyb20nIH0pLFxuICAgICAgZnAuZ2V0KCdjb250ZW50JyksXG4gICAgICBmcC5maW5kKHsgdHlwZTogJ3ZhbHVlJyB9KSxcbiAgICAgIGZwLmdldCgnY29udGVudCcpLFxuICAgICkpLFxuICAgIGZwLmZpbHRlcihmcC5jb21wb3NlKFxuICAgICAgZnAuZmluZCh7IHR5cGU6ICdpZGVudCcsIGNvbnRlbnQ6ICdjb21wb3NlcycgfSksXG4gICAgICBmcC5nZXQoJ2NvbnRlbnQnKSxcbiAgICAgIGZwLmZpbmQoeyB0eXBlOiAncHJvcGVydHknIH0pLFxuICAgICAgZnAuZ2V0KCdjb250ZW50JyksXG4gICAgKSksXG4gICkoZGVjbGFyYXRpb25zKTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRFeHRlbmRDbGFzc2VzTWFwID0gKGFzdDogZ0FTVE5vZGUpOiBjbGFzc01hcFR5cGUgPT4ge1xuICBjb25zdCBleHRlbmROb2RlcyA9IFtdO1xuICBhc3QudHJhdmVyc2VCeVR5cGUoJ2V4dGVuZCcsIG5vZGUgPT4gZXh0ZW5kTm9kZXMucHVzaChub2RlKSk7XG5cbiAgcmV0dXJuIGZwLmNvbXBvc2UoXG4gICAgZnAucmVkdWNlKChyZXN1bHQsIGtleSkgPT4ge1xuICAgICAgcmVzdWx0W2tleV0gPSB0cnVlOyAvLyBtYXJrIGV4dGVuZCBjbGFzc2VzIGFzIHRydWVcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSwge30pLFxuICAgIGZwLm1hcChmcC5jb21wb3NlKFxuICAgICAgZnAuZ2V0KCdjb250ZW50JyksXG4gICAgICBmcC5maW5kKHsgdHlwZTogJ2lkZW50JyB9KSxcbiAgICAgIGZwLmdldCgnY29udGVudCcpLFxuICAgICAgZnAuZmluZCh7IHR5cGU6ICdjbGFzcycgfSksXG4gICAgICBmcC5nZXQoJ2NvbnRlbnQnKSxcbiAgICAgIGZwLmZpbmQoeyB0eXBlOiAnc2VsZWN0b3InIH0pLFxuICAgICAgZnAuZ2V0KCdjb250ZW50JyksXG4gICAgKSksXG4gICkoZXh0ZW5kTm9kZXMpO1xufTtcblxuLyoqXG4gKiBSZXNvbHZlcyBwYXJlbnQgc2VsZWN0b3JzIHRvIHRoZWlyIGZ1bGwgY2xhc3MgbmFtZXMuXG4gKlxuICogRS5nLiBgLmZvbyB7ICZfYmFyIHtjb2xvcjogYmx1ZSB9IH1gIHRvIGAuZm9vX2JhcmAuXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRQYXJlbnRTZWxlY3RvckNsYXNzZXNNYXAgPSAoYXN0OiBnQVNUTm9kZSk6IGNsYXNzTWFwVHlwZSA9PiB7XG4gIGNvbnN0IGNsYXNzZXNNYXA6IGNsYXNzTWFwVHlwZSA9IHt9O1xuXG4gIC8vIFJlY3Vyc2l2ZWx5IHRyYXZlcnNlcyBkb3duIHRoZSB0cmVlIGxvb2tpbmcgZm9yIHBhcmVudCBzZWxlY3RvclxuICAvLyBleHRlbnNpb25zLiBSZWN1cnNpb24gaXMgbmVjZXNzYXJ5IGFzIHRoZXNlIHNlbGVjdG9ycyBjYW4gYmUgbmVzdGVkLlxuICBjb25zdCBnZXRFeHRlbnNpb25zID0gbm9kZUNvbnRlbnQgPT4ge1xuICAgIGNvbnN0IGJsb2NrQ29udGVudCA9IGZwLmNvbXBvc2UoXG4gICAgICBmcC5mbGF0TWFwKCdjb250ZW50JyksXG4gICAgICBmcC5maWx0ZXIoeyB0eXBlOiAnYmxvY2snIH0pXG4gICAgKShub2RlQ29udGVudCk7XG5cbiAgICBjb25zdCBydWxlc2V0c0NvbnRlbnQgPSBmcC5mbGF0TWFwKCdjb250ZW50JywgZnAuY29uY2F0KFxuICAgICAgLy8gYHJ1bGVzZXRgIGNoaWxkcmVuXG4gICAgICBmcC5maWx0ZXIoeyB0eXBlOiAncnVsZXNldCcgfSwgYmxvY2tDb250ZW50KSxcblxuICAgICAgLy8gYHJ1bGVzZXRgIGRlc2NlbmRhbnRzIG5lc3RlZCBpbiBgaW5jbHVkZWAgbm9kZXNcbiAgICAgIGZwLmNvbXBvc2UoXG4gICAgICAgIGZwLmZpbHRlcih7IHR5cGU6ICdydWxlc2V0JyB9KSxcbiAgICAgICAgZnAuZmxhdE1hcCgnY29udGVudCcpLFxuICAgICAgICBmcC5maWx0ZXIoeyB0eXBlOiAnYmxvY2snIH0pLFxuICAgICAgICBmcC5mbGF0TWFwKCdjb250ZW50JyksXG4gICAgICAgIGZwLmZpbHRlcih7IHR5cGU6ICdpbmNsdWRlJyB9KVxuICAgICAgKShibG9ja0NvbnRlbnQpXG4gICAgKSk7XG5cbiAgICBjb25zdCBleHRlbnNpb25zID0gZnAuY29tcG9zZShcbiAgICAgIGZwLm1hcCgnY29udGVudCcpLFxuICAgICAgZnAuZmlsdGVyKHsgdHlwZTogJ2lkZW50JyB9KSxcbiAgICAgIGZwLmZsYXRNYXAoJ2NvbnRlbnQnKSxcbiAgICAgIGZwLmZpbHRlcih7IHR5cGU6ICdwYXJlbnRTZWxlY3RvckV4dGVuc2lvbicgfSksXG4gICAgICBmcC5mbGF0TWFwKCdjb250ZW50JyksXG4gICAgICBmcC5maWx0ZXIoeyB0eXBlOiAnc2VsZWN0b3InIH0pXG4gICAgKShydWxlc2V0c0NvbnRlbnQpO1xuXG4gICAgaWYgKCFleHRlbnNpb25zLmxlbmd0aCkgcmV0dXJuIFtdO1xuXG4gICAgY29uc3QgbmVzdGVkRXh0ZW5zaW9ucyA9IGdldEV4dGVuc2lvbnMocnVsZXNldHNDb250ZW50KTtcbiAgICBjb25zdCByZXN1bHQgPSBleHRlbnNpb25zO1xuICAgIGlmIChuZXN0ZWRFeHRlbnNpb25zLmxlbmd0aCkge1xuICAgICAgbmVzdGVkRXh0ZW5zaW9ucy5mb3JFYWNoKG5lc3RlZEV4dCA9PiB7XG4gICAgICAgIGV4dGVuc2lvbnMuZm9yRWFjaChleHQgPT4ge1xuICAgICAgICAgIHJlc3VsdC5wdXNoKGV4dCArIG5lc3RlZEV4dCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBhc3QudHJhdmVyc2VCeVR5cGUoJ3J1bGVzZXQnLCBub2RlID0+IHtcbiAgICBjb25zdCBjbGFzc05hbWVzID0gZnAuY29tcG9zZShcbiAgICAgIGZwLm1hcCgnY29udGVudCcpLFxuICAgICAgZnAuZmlsdGVyKHsgdHlwZTogJ2lkZW50JyB9KSxcbiAgICAgIGZwLmZsYXRNYXAoJ2NvbnRlbnQnKSxcbiAgICAgIGZwLmZpbHRlcih7IHR5cGU6ICdjbGFzcycgfSksXG4gICAgICBmcC5mbGF0TWFwKCdjb250ZW50JyksXG4gICAgICBmcC5maWx0ZXIoeyB0eXBlOiAnc2VsZWN0b3InIH0pXG4gICAgKShub2RlLmNvbnRlbnQpO1xuXG4gICAgaWYgKCFjbGFzc05hbWVzLmxlbmd0aCkgcmV0dXJuO1xuXG4gICAgY29uc3QgZXh0ZW5zaW9ucyA9IGdldEV4dGVuc2lvbnMobm9kZS5jb250ZW50KTtcbiAgICBpZiAoIWV4dGVuc2lvbnMubGVuZ3RoKSByZXR1cm47XG5cbiAgICBjbGFzc05hbWVzLmZvckVhY2goY2xhc3NOYW1lID0+IHtcbiAgICAgIGV4dGVuc2lvbnMuZm9yRWFjaChleHQgPT4ge1xuICAgICAgICBjbGFzc2VzTWFwW2NsYXNzTmFtZSArIGV4dF0gPSBmYWxzZTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBJZ25vcmUgdGhlIGJhc2UgY2xhc3MgaWYgaXQgb25seSBleGlzdHMgZm9yIG5lc3RpbmcgcGFyZW50IHNlbGVjdG9yc1xuICAgICAgY29uc3QgaGFzRGVjbGFyYXRpb25zID0gZnAuY29tcG9zZShcbiAgICAgICAgZnAuZmlsdGVyKHsgdHlwZTogJ2RlY2xhcmF0aW9uJyB9KSxcbiAgICAgICAgZnAuZmxhdE1hcCgnY29udGVudCcpLFxuICAgICAgICBmcC5maWx0ZXIoeyB0eXBlOiAnYmxvY2snIH0pXG4gICAgICApKG5vZGUuY29udGVudCkubGVuZ3RoID4gMDtcbiAgICAgIGlmICghaGFzRGVjbGFyYXRpb25zKSBjbGFzc2VzTWFwW2NsYXNzTmFtZV0gPSB0cnVlO1xuICAgIH0pO1xuICB9KTtcblxuICByZXR1cm4gY2xhc3Nlc01hcDtcbn07XG5cbi8qKlxuICogTXV0YXRlcyB0aGUgQVNUIGJ5IHJlbW92aW5nIGA6Z2xvYmFsYCBpbnN0YW5jZXMuXG4gKlxuICogRm9yIHRoZSBBU1Qgc3RydWN0dXJlOlxuICogQHNlZSBodHRwczovL2dpdGh1Yi5jb20vY3NzL2dvbnphbGVzL2Jsb2IvbWFzdGVyL2RvYy9BU1QuQ1NTUC5lbi5tZFxuICovXG5leHBvcnQgY29uc3QgZWxpbWluYXRlR2xvYmFscyA9IChhc3Q6IGdBU1ROb2RlKSA9PiB7XG4gIC8vIFJlbW92ZSBhbGwgOmdsb2JhbC86Z2xvYmFsKC4uLikgaW4gc2VsZWN0b3JzXG4gIGFzdC50cmF2ZXJzZUJ5VHlwZSgnc2VsZWN0b3InLCAoc2VsZWN0b3JOb2RlKSA9PiB7XG4gICAgY29uc3Qgc2VsZWN0b3JDb250ZW50ID0gc2VsZWN0b3JOb2RlLmNvbnRlbnQ7XG4gICAgbGV0IGhhc0dsb2JhbFdpdGhOb0FyZ3MgPSBmYWxzZTtcbiAgICBsZXQgaSA9IDA7XG4gICAgbGV0IGN1cnJOb2RlID0gc2VsZWN0b3JDb250ZW50W2ldO1xuICAgIHdoaWxlIChjdXJyTm9kZSkge1xuICAgICAgaWYgKGN1cnJOb2RlLmlzKCdwc2V1ZG9DbGFzcycpKSB7XG4gICAgICAgIC8vIFJlbW92ZSBhbGwgOmdsb2JhbC86Z2xvYmFsKC4uLikgYW5kIHRyYWlsaW5nIHNwYWNlXG4gICAgICAgIGNvbnN0IGlkZW50aWZpZXJOb2RlID0gY3Vyck5vZGUuY29udGVudFswXTtcbiAgICAgICAgaWYgKGlkZW50aWZpZXJOb2RlICYmIGlkZW50aWZpZXJOb2RlLmNvbnRlbnQgPT09ICdnbG9iYWwnKSB7XG4gICAgICAgICAgaWYgKGN1cnJOb2RlLmNvbnRlbnQubGVuZ3RoID09PSAxKSBoYXNHbG9iYWxXaXRoTm9BcmdzID0gdHJ1ZTtcbiAgICAgICAgICBzZWxlY3Rvck5vZGUucmVtb3ZlQ2hpbGQoaSk7XG4gICAgICAgICAgaWYgKHNlbGVjdG9yQ29udGVudFtpXSAmJiBzZWxlY3RvckNvbnRlbnRbaV0uaXMoJ3NwYWNlJykpIHtcbiAgICAgICAgICAgIHNlbGVjdG9yTm9kZS5yZW1vdmVDaGlsZChpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaSsrO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGN1cnJOb2RlLmlzKCdjbGFzcycpICYmIGhhc0dsb2JhbFdpdGhOb0FyZ3MpIHtcbiAgICAgICAgLy8gUmVtb3ZlIGFsbCBjbGFzcyBhZnRlciA6Z2xvYmFsIGFuZCB0aGVpciB0cmFpbGluZyBzcGFjZVxuICAgICAgICBzZWxlY3Rvck5vZGUucmVtb3ZlQ2hpbGQoaSk7XG4gICAgICAgIGlmIChzZWxlY3RvckNvbnRlbnRbaV0gJiYgc2VsZWN0b3JDb250ZW50W2ldLmlzKCdzcGFjZScpKSB7XG4gICAgICAgICAgc2VsZWN0b3JOb2RlLnJlbW92ZUNoaWxkKGkpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpKys7XG4gICAgICB9XG5cbiAgICAgIGN1cnJOb2RlID0gc2VsZWN0b3JDb250ZW50W2ldO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gUmVtb3ZlIGFsbCBydWxlc2V0IHdpdGggbm8gc2VsZWN0b3JzXG4gIGFzdC50cmF2ZXJzZUJ5VHlwZSgncnVsZXNldCcsIChub2RlLCBpbmRleCwgcGFyZW50KSA9PiB7XG4gICAgY29uc3QgcnVsZXNldENvbnRlbnQgPSBub2RlLmNvbnRlbnQ7XG5cbiAgICAvLyBSZW1vdmUgZW1wdHkgc2VsZWN0b3JzIGFuZCB0cmFpbGluZyBkZWxpbWluYXRvciBhbmQgc3BhY2VcbiAgICBsZXQgaSA9IDA7XG4gICAgbGV0IGN1cnJOb2RlID0gcnVsZXNldENvbnRlbnRbaV07XG4gICAgd2hpbGUgKGN1cnJOb2RlKSB7XG4gICAgICBpZiAoY3Vyck5vZGUuaXMoJ3NlbGVjdG9yJykgJiYgY3Vyck5vZGUuY29udGVudC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgbm9kZS5yZW1vdmVDaGlsZChpKTtcbiAgICAgICAgaWYgKHJ1bGVzZXRDb250ZW50W2ldLmlzKCdkZWxpbWl0ZXInKSkgbm9kZS5yZW1vdmVDaGlsZChpKTtcbiAgICAgICAgaWYgKHJ1bGVzZXRDb250ZW50W2ldLmlzKCdzcGFjZScpKSBub2RlLnJlbW92ZUNoaWxkKGkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaSsrO1xuICAgICAgfVxuICAgICAgY3Vyck5vZGUgPSBydWxlc2V0Q29udGVudFtpXTtcbiAgICB9XG5cbiAgICAvLyBSZW1vdmUgdGhlIHJ1bGVzZXQgaWYgbm8gc2VsZWN0b3JzXG4gICAgaWYgKHJ1bGVzZXRDb250ZW50LmZpbHRlcigobm9kZSkgPT4gbm9kZS5pcygnc2VsZWN0b3InKSkubGVuZ3RoID09PSAwKSB7XG4gICAgICBwYXJlbnQucmVtb3ZlQ2hpbGQoaW5kZXgpO1xuICAgIH1cbiAgfSk7XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFFQSxJQUFBQSxHQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBMkIsU0FBQUQsdUJBQUFFLEdBQUEsV0FBQUEsR0FBQSxJQUFBQSxHQUFBLENBQUFDLFVBQUEsR0FBQUQsR0FBQSxnQkFBQUEsR0FBQTtBQUQzQjtBQVNPLElBQU1FLHFCQUFx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